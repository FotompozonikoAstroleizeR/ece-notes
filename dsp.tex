% !TeX program = xelatex
\documentclass[11pt,a4paper,notitlepage,fleqn]{article}

\input{preamble.tex}

\title{ΨΕΣ
	\\
	{ 
		\normalsize Ψηφιακή Επεξεργασία Σήματος
		\\
		\normalsize Σημειώσεις από τις παραδόσεις\footnote{Όπως διδάσκονται στο τμήμα \textit{Ηλεκτρολόγων Μηχανικών και Μηχανικών Υπολογιστών} στο \textit{Αριστοτέλειο Πανεπιστήμιο Θεσσαλονίκης}.}
	}}
\date{Οκτώβριος 2018
	\\
	{ 
		\small Τελευταία ενημέρωση: \today
	}
}
\author{
	Για τον κώδικα σε \LaTeX, ενημερώσεις και προτάσεις:
	\\
	\url{https://github.com/kongr45gpen/ece-notes}}

\setallmainfonts(Digits,Latin,Greek){Asana Math}
\setmainfont{Noto Serif}
\setsansfont{Ubuntu}
\usepackage{polyglossia}
\newfontfamily\greekfont[Script=Greek,Scale=1.00]{Liberation Serif}

\hypersetup{pdftitle = {Ψηφιακή Επεξεργασία Σήματος}}

\let\mytodo\todo
\renewcommand{\todo}[1]{\par\mytodo[inline,noline]{#1}}


\begin{document}
\maketitle

\hrule
\vspace{50pt}

\begin{infobox}{Λάθη \& Διορθώσεις}
	Οι τελευταίες εκδόσεις των σημειώσεων βρίσκονται στο Github
	(\url{https://github.com/kongr45gpen/ece-notes/raw/master/dsp.pdf}) ή
	στη διεύθυνση \url{http://helit.org/ece-notes/dsp.pdf}.
	
	Περιέχουν διορθώσεις σε λάθη και τυχόν βελτιώσεις.
	
	\tcblower
	
	Μπορείτε να ενημερώνετε για οποιοδήποτε λάθος και πρόταση
	μέσω PM στο forum, issue στο Github, ή οποιουδήποτε άλλου τρόπου!
\end{infobox}

\section{Εισαγωγή}
	
Στο μάθημα της \textbf{Ψηφιακής Επεξεργασίας Σήματος} ασχολούμαστε
με προβλήματα όπως το εξής:

Παλιότερα, αν μας ζητούνταν να κατασκευάσουμε ένα φίλτρο (π.χ.
ζωνοπερατό από 20 Hz - 500 kHz), μπορούσαμε πολύ εύκολα να αγοράσουμε μια σακούλα με
όλα τα εξαρτήματα (πυκνωτές, αντιστάσεις, \textellipsis) από ένα
κατάστημα και να φτιάξουμε το κύκλωμα.

Αν αργότερα μας ζητούσαν να φτιάξουμε ένα φίλτρο 20 Hz - 300 kHz, θα
έπρεπε να ξαναπάμε στο κατάστημα και να αγοράσουμε ξανά νέα σακούλα και νέα εξαρτήματα
και να ξανακατασκευάσουμε το κύκλωμα.

Από τη στιγμή όμως που εφευρέθηκαν οι υπολογιστές, φανταστήκαμε να τους
χρησιμοποιήσουμε και για να πραγματοποιήσουμε την παραπάνω διαδικασία και
να αλλάζουμε προδιαγραφές όσο συχνά θέλουμε χωρίς να τρέχουμε στο κατάστημα.

Αυτή η διαδικασία απαιτεί τα εξής:
\begin{itemize}
	\item Πρέπει να μετατρέψουμε το \textit{πραγματικό} \textit{αναλογικό}
	σήμα σε μια μορφή που αναγνωρίζει αυτός ο υπολογιστής. Δηλαδή να μετατραπεί
	από αναλογικό σε ψηφιακό. Αυτό γίνεται με δύο βήματα:
	\begin{enumerate}
		\item \textbf{Δειγματοληψία}. Πρώτα πρέπει με έναν συγκεκριμένο τρόπο
		να λάβουμε \textit{δείγματα} σε \textit{διακριτές} στιγμές του αρχικού
		αναλογικού σήματος. Αφού ο υπολογιστής δεν μπορεί να αποθηκεύσει
		άπειρες τιμές, αναγκαστικά θα λάβουμε ένα πεπερασμένο εύρος τους.
		
		\begin{tikzpicture}
		\def\points{(0,0) (0.2,0.2) (0.4,0.5) (0.6,0.7)
			(0.8,0.9) (1,0.7) (1.2,0.6) (1.4,1) (1.6,0.8) (1.8,0.8) (2,1.1) (2.2,1.4)
			(2.4, 1.2) (2.6,1.1) (2.8,1) (3,0.95)
		}
		\def\pointsc{(0,0),(0.2,0.2),(0.4,0.5),(0.6,0.7),(0.8,0.9),(1,0.7),(1.2,0.6),(1.4,1),(1.6,0.8),(1.8,0.8),(2,1.1),(2.2,1.4),(2.4, 1.2),(2.6,1.1),(2.8,1),(3,0.95)
		}
		\def\pointsr{(0,0),(0.2,0.21),(0.4,0.42),(0.6,0.63),(0.8,0.84),(1,0.63),(1.2,0.63),(1.4,1.05),(1.6,0.84),(1.8,0.84),(2,1.05),(2.2,1.47),(2.4, 1.26),(2.6,1.05),(2.8,1.05),(3,0.84)
		}
		
		\draw[->] (0,0) -- (3,0) node[below] {$t$};
		\draw[->] (0,0) -- (0,2) node[left] (xt) {$x(t)$} node[right,align=left,scale=.7] {αναλογικό\\σήμα};
		\draw (xt.south) node[below,scale=.7,yshift=2mm] {$\in\mathbb R$};
		
		\draw[\timecolour,thick]
		plot [smooth] coordinates \points;
		
		\foreach \p in \pointsc
		\filldraw[red,top color=white,bottom color=blue,opacity=.4] \p circle(0.05);
		
		\draw[<->,thick,opacity=.9]
		(3.75,1) -- ++(1,0);
		
		\begin{scope}[xshift=5.5cm]
		\draw[->] (0,0) -- (3,0) node[below] {$n\in\mathbb N$};
		\draw[->] (0,0) -- (0,2) node[left] (xn) {$x(n)$} node[right,align=left,scale=.7] {διακριτό\\σήμα};
		
		\draw (xn.south) node[below,scale=.7,yshift=2mm] {$\in\mathbb R$};
		
		\foreach \p in \pointsc
		\filldraw[draw=black,top color=white,bottom color=blue,opacity=.4] \p circle(0.05);
		\end{scope}
		
		\end{tikzpicture}
		
		Αυτό το σήμα ονομάζεται \textbf{διακριτό} (\textbf{discrete}).
		\item \textbf{Κβάντωση}. Στον αναλογικό κόσμο, οι πεπερασμένες τιμές έχουν
		άπειρη ακρίβεια. Όμως στον υπολογιστή δεν μπορούμε να αποθηκεύσουμε άπειρα
		δεκαδικά ψηφία, αλλά πρέπει να τα αποθηκεύσουμε σε πεπερασμένες στάθμες
		που μας επιτρέπεται να χρησιμοποιηθούν.
		
		\begin{tikzpicture}
		\def\points{(0,0) (0.2,0.2) (0.4,0.5) (0.6,0.7)
			(0.8,0.9) (1,0.7) (1.2,0.6) (1.4,1) (1.6,0.8) (1.8,0.8) (2,1.1) (2.2,1.4)
			(2.4, 1.2) (2.6,1.1) (2.8,1) (3,0.95)
		}
		\def\pointsc{(0,0),(0.2,0.2),(0.4,0.5),(0.6,0.7),(0.8,0.9),(1,0.7),(1.2,0.6),(1.4,1),(1.6,0.8),(1.8,0.8),(2,1.1),(2.2,1.4),(2.4, 1.2),(2.6,1.1),(2.8,1),(3,0.95)
		}
		\def\pointsr{(0,0),(0.2,0.21),(0.4,0.42),(0.6,0.63),(0.8,0.84),(1,0.63),(1.2,0.63),(1.4,1.05),(1.6,0.84),(1.8,0.84),(2,1.05),(2.2,1.47),(2.4, 1.26),(2.6,1.05),(2.8,1.05),(3,0.84)
		}
		
		\draw[->] (0,0) -- (3,0) node[below] {$t$};
		\draw[->] (0,0) -- (0,2) node[left] (xt) {$x(t)$} node[right,align=left,scale=.7] {αναλογικό\\σήμα};
		\draw (xt.south) node[below,scale=.7,yshift=2mm] {$\in\mathbb R$};
		
		\draw[blue!50!cyan!80!brown,thick]
		plot [smooth] coordinates \points;
		
		\foreach \p in \pointsc
		\filldraw[red,top color=white,bottom color=blue,opacity=.4] \p circle(0.05);
		
		\draw[<->,thick,opacity=.9]
		(3.75,1) -- ++(1,0);
		
		\begin{scope}[xshift=5.5cm]
		\draw[->] (0,0) -- (3,0) node[below] {$n\in\mathbb N$};
		\draw[->] (0,0) -- (0,2) node[left] (xn) {$x(n)$} node[right,align=left,scale=.7] {διακριτό\\σήμα};
		
		\draw (xn.south) node[below,scale=.7,yshift=2mm] {$\in\mathbb R$};
		
		\foreach \y in {0,0.21,...,1.6}
		\draw[blue,opacity=.5,densely dashed] (0,\y) -- ++(3,0);
		
		\foreach \p in \pointsc
		\filldraw[draw=black,top color=white,bottom color=blue,opacity=.4] \p circle(0.05);
		\end{scope}
		
		\draw[->,thick,opacity=.9]
		(9.5,1) -- ++(1,0);
		
		\begin{scope}[xshift=11.25cm]
		\draw[->] (0,0) -- (3,0) node[below] {$n\in\mathbb N$};
		\draw[->] (0,0) -- (0,2) node[left] (xn) {$x(n)$} node[right,align=left,scale=.7] {ψηφιακό\\σήμα};
		
		\draw (xn.south) node[below,scale=.9,yshift=1mm] {$\in\mathbb Z$};
		
		\foreach \y in {0,0.21,...,1.6}
		\draw[blue,opacity=.5,densely dashed] (0,\y) -- ++(3,0);
		
		\foreach \p in \pointsr
		\filldraw[draw=black,top color=white!50!red,bottom color=blue,opacity=.4] \p circle(0.05);
		\end{scope}
		
		\end{tikzpicture}
		
		Αυτό το σήμα ονομάζεται \textbf{ψηφιακό} (\textbf{digital}).
	\end{enumerate}

	Σε αυτό το μάθημα, παρά τον τίτλο του, θα ασχοληθούμε με \textbf{διακριτά σήματα}, και
	όχι ψηφιακά.
	
	Για να επεξεργαστούμε τα σήματα, υποθέτουμε ότι θα υπάρχει μια συσκευή που
	μετατρέπει το \textit{Αναλογικό σήμα} σε \textit{Διακριτό σήμα} με τέτοιον τρόπο
	ώστε να μπορούμε να γυρίσουμε πίσω και να μπορούμε να το επεξεργαστούμε με έναν
	ασφαλή τρόπο που θα επιστρέψει σίγουρα σωστό αποτέλεσμα. Αυτό το εξασφαλίζει το
	\textbf{θεώρημα δειγματοληψίας} (Nyquist-Shannon), σύμφωνα με το οποίο για να
	αναπαραστήσουμε ένα ζωνοπερατό σήμα, αρκεί να το δειγματοληπτήσουμε με συχνότητα διπλάσια
	της μέγιστης συχνότητας του σήματος.
	
	Στην πραγματικότητα βέβαια, το θεώρημα δειγματοληψίας απαιτεί να δειγματοληπτούμε για άπειρο
	χρόνο, κάτι μη πραγματικά εφικτό. Μάλιστα, τα πραγματικά σήματα είναι \textit{χρονοπερατά}, άρα
	\textit{μη ζωνοπερατά}, επομένως εν γένει δεν εφαρμόζεται το θεώρημα δειγματοληψίας. Όμως η παραπάνω
	διαδικασία μπορούμε να πούμε ότι δίνει προσεγγιστικά ορθό αποτέλεσμα.
	
	Ακόμα, υπάρχουν σήματα που είναι από τη φύση τους ψηφιακά, όπως τιμές χρηματιστηρίου, ακολουθίες,
	δεδομένα, followers στο instagram, \textellipsis
	
	\item Παραμένει η ίδια η \textbf{επεξεργασία} του σήματος. Αυτή γίνεται με κώδικα ενός αλγορίθμου
	που εκτελεί πράξεις, δεδομένου ότι έχει επεξεργαστεί το σήμα σωστά.
\end{itemize}

Σχηματικά:

\begin{tikzpicture}

\pgfdeclarelayer{foreground}
\pgfsetlayers{main,foreground}

\draw[fill=yellow,draw opacity=.7,fill opacity=.15] (2.2,1.6) rectangle (5.2,-0.7) node[below,opacity=.7,circle,draw,inner sep=1pt,outer sep=2pt] {$A$};
\draw[fill=yellow,draw opacity=.7,fill opacity=.15] (-0.4,-2.3) rectangle (8.39,-3.7) node[below,opacity=.7,circle,draw,inner sep=1pt,outer sep=2pt] {$B$};

\draw (-2,0.5) node[scale=.9,align=center] {αναλογικός\\κόσμος};

\draw (0,0) --(1,0);
\draw (0,0) --(0,1);
\draw[\timecolour] plot[variable=\x,domain=0:1,samples=10,smooth]
(\x,{\x*((1+rand*0.3))});

\ctikzset{bipoles/length=.6cm}

\begin{pgfonlayer}{foreground}
\begin{scope}[xshift=3cm,yshift=1cm,local bounding box=scope1]
\draw (-0.1,0) node {};
\draw (0,0) to[L] ++(0.5,0);
\draw (0,-0.3) to[C] ++(0.5,0);
\draw (0,-0.7) to[R] ++(0.5,0);
\draw (0,-1.1) to[D] ++(0.5,0);

\draw (1.2,0) node {$H(\omega)$};
\draw (1.2,-0.4) node {$H(s)$};
\draw (1.2,-0.8) node {$h(t)$};
\draw (1.2,-1.2) node {???};
\end{scope}
\end{pgfonlayer}
\draw[fill=white] (scope1.north west) rectangle (scope1.south east);

\draw[<-] (scope1.west) -- ++(-1,0) node[left] {$x(t)$};
\draw[->] (scope1.east) -- ++(1,0) node[right] {$y(t)$};

\begin{scope}[xshift=6.5cm]
\draw (0,0) --(1.1,0);
\draw (0,0) --(0,1);
\draw[\timecolour] plot[variable=\x,domain=0:1,samples=10,smooth]
(\x,{(1-\x)*((0.9+rand*0.3))});
\end{scope}

\begin{scope}[yshift=-3cm]
\draw (-2,0) node[scale=.9,align=center] {ψηφιακός\\κόσμος};

\draw (1,0) node[rectangle,draw] (b1) {A$\to$D converter};
\draw (4,0) node[rectangle,scale=.8,draw,align=center] (b2)
{Algorithm\\Code\\ALU+Memory};
\draw (7,0) node[rectangle,draw] (b3) {D$\to$A converter};

\draw[<-] (b1.west) -- ++(-0.2,0) node[left,scale=.8] {$x(t)$};
\draw[->] (b1) -- (b2);
\draw[->] (b2) -- (b3);
\draw[->] (b3.east) -- ++(0.15,0) node[right,scale=.8] {$y(t)$};
\end{scope}
\end{tikzpicture}

Θέλουμε η διαδικασία \( A \) που είναι ένα \textbf{πραγματικό, φυσικό} φίλτρο ή κύκλωμα, να βγάζει
περίπου ίδιο αποτέλεσμα με μια διαδικασία \( B \) που υλοποιούμε ψηφιακά, δηλαδή:
\[
A \simeq B
\]
ή, ισοδύναμα για τα σήματα \( x(t) \) και \( y(t) \):
\begin{align*}
	A\left[x(t)\right] &\simeq B\left[x(t)\right] \\
	y_{\mathrm{analog}}(t) &\simeq y_{\mathrm{digital}}(t)
\end{align*}

\subsection{Ιδιότητες}
Όταν μιλάμε για διακριτό σήμα, μιλάμε ουσιαστικά για μία ακολουθία, όπως τη γνωρίζουμε από τα μαθηματικά.

\paragraph{Πράξεις}
Οι πράξεις σημάτων ορίζονται όπως και στις ακολουθίες. Ασχολούμαστε με τιμές ίδιων \textbf{δεικτών} (indices) \( n \):
\begin{enumerate}
	\item \textbf{Πρόσθεση}: \( x(n) + y(n) = z(n) \)
	\item \textbf{Πολλαπλασιασμός ακολουθιών}: \( x(n) \cdot y(n) = z(n) \)
	\item \textbf{Πολλαπλασιασμός αριθμού-ακολουθίας}: \( a\in\mathbb R,\ z(n) = a\cdot x(n) \)
\end{enumerate}

\paragraph{Άθροισμα γεωμετρικής προόδου}
Η γεωμετρική πρόοδος έχει σημαντική θέση στην ψηφιακή επεξεργασία σήματος (αφού στο αναλογικό σήμα
είχαμε το σημαντικό \( e^{j\omega t} \), εδώ είναι σημαντικό το \( e^{j\omega n} \) που εκφράζει συνεχή πολλαπλασιασμό με το \( e^{j\omega } \)):
\[
\sum_{n=0}^{\infty} a^n
= \begin{cases}
\displaystyle \frac{1}{1-a} &,\quad |a|<1\\
\text{αποκλίνει}&,\quad |a|>1
\end{cases}
\]
(για \( a=1 \) αποκλίνει, και για \( a=-1 \) ταλαντεύεται. Επίσης, η παραπάνω σχέση ισχύει και για
\( a\in\mathbb C \)).

\textbf{Προσοχή} ότι η παραπάνω σχέση ισχύει μόνο όταν το \( n \) ξεκινάει από το 0. Για παράδειγμα,
\( \sum_{n=1}^{\left(\frac{1}{2}\right)^n} = \frac{1}{1-\frac{1}{2}}-1 = 1 \).

Για \textbf{πεπερασμένο αριθμό όρων}:
\[
\sum_{n=0}^{N} a^n
= \frac{1-a^{n+1}}{1-a}
\]

\subsubsection{Χρήσιμοι τύποι ακολουθιών}
\paragraph{Περιοδική ακολουθία}
Η περιοδική ακολουθία περιέχει όρους που επαναλαμβάνονται, όπως και μία περιοδική συνάρτηση.
Μαθηματικά:
\[
\exists N \in \mathbb Z: \ \forall n \in \mathbb Z: \ x(n) = x(n+N)
\]
δηλαδή η περιοδική μας ακολουθία έχει μια \textbf{περίοδο \( \mathbb N \)} που είναι ακέραιος αριθμός.

\textbf{Προσοχή!} Δεδομένου ότι η \( \cos(\omega t) \) είναι \textit{περιοδική}, θα μπορούσε κάποιος
να φαντασεί ότι και η \( \cos(\omega n) \) είναι \textit{περιοδικό διακριτό σήμα}. Αν το δούμε μαθηματικά:
Έστω \( \exists N \in \mathbb Z:\ \cos(\omega n)=\cos\left( \omega (n+N) \right)
\implies \omega n = \omega n + \omega N + kπ \implies N = \frac{π}{\omega } \notin \mathbb Z \).

\begin{tikzpicture}[scale=.8]
\def\freq{0.5}

\draw (0,0) node[left,align=right,scale=.8] {περιοδικό\\ψηφιακό\\σήμα};

\draw (0,0) -- (10,0);
\draw (0,-1.5) -- (0,1.5);

\begin{scope}[green!50!black,opacity=.6]
\draw (0.5,1) -- (0.5,-1.5);
\draw (1,0) -- (1,-1.5);
\draw[<->] ([xshift=-1mm]1,-1.3) -- ([xshift=1mm]0.5,-1.3) node[below,yshift=-3mm,scale=.6,midway] {$f_s=2\;\mathrm{Hz}$};
\end{scope}

\draw[thick,timecolour]
plot[domain=0:9,samples=\lowsamples,smooth] (\x,{sin(\freq*2*pi*\x r)});

\foreach \x in {0.5,1,...,9} {
	\def\sample{sin(\freq*2*pi*\x r)}
	\draw[dashed,orange] (\x,0) -- (\x,{\sample});
	\filldraw[fill opacity=.8,fill=orange!50!white] (\x,{\sample}) circle (2.5pt);
}

\begin{scope}[yshift=-4cm]
\draw (0,0) node[left,align=right,scale=.8] {\emph{μη} περιοδικό\\ψηφιακό\\σήμα};

\draw (0,0) -- (10,0);
\draw (0,-1.5) -- (0,1.5);

\begin{scope}[green!50!black,opacity=.6]
\draw (0.55,{sin(\freq*2*pi*0.55 r)}) -- (0.55,-1.5);
\draw (1.1,{sin(\freq*2*pi*1.1 r)}) -- (1.1,-1.5);
\draw[<->] ([xshift=-1mm]1.1,-1.3) -- ([xshift=1mm]0.55,-1.3) node[below,yshift=-3mm,scale=.6,midway] {$f_s=1.28\sqrt{2}\;\mathrm{Hz}$};
\end{scope}

\draw[thick,timecolour]
plot[domain=0:9,samples=\lowsamples,smooth] (\x,{sin(\freq*2*pi*\x r)});

\foreach \x in {0.55,1.1,...,9} {
	\def\sample{sin(\freq*2*pi*\x r)}
	\draw[dashed,red] (\x,0) -- (\x,{\sample});
	\filldraw[fill opacity=.8,fill=red!50!white] (\x,{\sample}) circle (2.5pt);
}
\end{scope}
\end{tikzpicture}

Πρακτικά, δειγματοληπτούμε σε διαφορετικά σημεία, άσχετα ίσως από την περίοδο του σήματος. Γενικότερα,
όταν δειγματοληπτούμε περιοδικά αναλογικά σήματα, δεν θα παίρνουμε πάντα περιοδικά διακριτά πίσω.

Μάλιστα, κάτι άλλο περίεργο όταν δειγματοληπτούμε είναι πως για διαφορετικά αναλογικά σήματα, μπορεί
να πάρουμε το ίδιο ψηφιακό!

\begin{tikzpicture}
\draw (0,1.5) -- (0,-1.5);
\draw[->] (0,0) -- (5,0) node[below] {$t$};

\draw[\timecolour!40!black,very thick]
plot[samples=\lowsamples,smooth,domain=0:4,variable=\x]
(\x,{1.1*sin((\x*1.25*pi) r)});
\draw[\timecolour,very thick]
(0,0) -- (1/4*1.6,1) -- (3/4*1.6,-1) -- (5/4*1.6,1) -- (7/4*1.6,-1)
-- (9/4*1.6,1);
\end{tikzpicture}

Στο παραπάνω σχήμα, δειγματοληπτώντας στις κορυφές και στα μηδενικά, θα πάρουμε το ίδιο πράγμα από
τα δύο σήματα.

\paragraph{Άρτιες \& Περιττές ακολουθίες}
\begin{align*}
	\text{άρτια (even)} &\quad \forall n \in \mathbb Z \ x_e(n) = x_e(-n) \\
	\text{περιττή (odd)} &\quad \forall n \in \mathbb Z \ -x_o(n) = x_o(-n)
\end{align*}

Μπορούμε να μετατρέψουμε οποιαδήποτε ακολουθία σε ένα άρτιο και ένα περιττό μέρος:
\begin{align*}
	x_e(n) &= \frac{x(n) + x(-n)}{2}\\
	x_o(n) &= \frac{x(n) - x(-n)}{2}
\end{align*}

\subsubsection{Χαρακτηριστικά Μεγέθη}
\begin{enumerate}
	\item \textbf{Μέση τιμή}:
	\( \displaystyle
	\overline{x(n)} = \frac{\displaystyle \sum_{n=0}^{N} x(n)}{N+1}
	 \)
	\item \textbf{Ενεργός τιμή}:
	\( 
	\displaystyle
	\overline{\overline{x(n)}} = \left[
	\frac{\displaystyle \sum_{n=0}^{N} x^2(n)}{N+1}
	\right]^{\sfrac{1}{2} }
	 \)
	\item \textbf{Στιγμιαία ισχύς}:
	\( 
	\displaystyle
	p(n) = x^2(n)
	 \)
	\item \textbf{Μέση Ισχύς}:
	\( 
	\displaystyle
	p = \overline{p(n)} = \frac{\displaystyle \sum_{n=0}^{N} x^2(n)}{N+1}
	 \)
	\item \textbf{Ενέργεια}:	\todo{Check}
	\( 
	\displaystyle
	W = \sum_{n=0}^{N} x^2(n) = (N+1)p
	 \)
\end{enumerate}

\pagebreak[3]

\subsubsection{Χρήσιμες ακολουθίες}
\begin{enumpar}
	\item \textbf{Εκθετική ακολουθία}: \todo{Box this in a cool way}
	\begin{minipage}{.5\textwidth}
		\begin{knowledgebox}{Εκθετική ακολουθία}
		\[ \displaystyle
		x(n) = Ae^{sn} = Aa^{(\sigma + j \omega )n}
		\]
		\end{knowledgebox}

		για την οποία λαμβάνουμε τις εξής περιπτώσεις για τις σταθερές:
		\begin{itemize}
			\item \( a=e \) και \( s = \sigma < 0 \):
			\[
			x(n) = Ae^{-|σ|n}
			\]
			(γεωμετρική πρόοδος με λόγο \( e^{-|σ|} \))
			\item \( a=e \) και \( s = \pm j\omega  \):
			\[
			x(n) = A\left[
			cos(\omega n) \pm j \sin(\omega n)
			\right]
			\]
			
			Είναι περιοδική \textit{μόνο} εάν \( \frac{\pi}{\omega } \in \mathbb Q \)
		\end{itemize}
	\end{minipage}
	\begin{minipage}{.5\textwidth}
		\begin{tikzpicture}
		\tikzstyle{sample}=[bottom color=orange,top color=\timecolour,fill opacity=.7,rounded corners=2.5pt,thick]
		
		\draw[->] (-3,0) -- (3.5,0);
		\draw[->] (0,0) -- (0,2)  node[right] {$x(n)$};
		
		\def\sf{0.7}
		\def\sx{0.11}
		\def\sy{0.09}
		
		\foreach \x in {-4,-3,...,4} {
			\draw (\x*\sf-0.1,0.1) -- (\x*\sf+0.1,-0.1);
			\draw (\x*\sf,-0.1) node[below,scale=.9] {$\x$};
		}
		
		\foreach \x in {-4,-3,...,4} {
			\filldraw[sample] (\x*\sf + \sx,{exp(\x/3)/2 + \sy}) rectangle ++(-\sx*2,-\sy*2);
		}
		\end{tikzpicture}
	\end{minipage}
    \item \textbf{Δέλτα του Kronecker}:

    \begin{minipage}{.5\textwidth}
    	\begin{knowledgebox}{Δέλτα του Kronecker}
    		\[ \displaystyle
    		\delta(n) = \begin{cases}
    		1 &\quad n=0\\
    		0 &\quad n\neq 0
    		\end{cases}
    		\]
    	\end{knowledgebox}
    \end{minipage}
	\begin{minipage}{.5\textwidth}
		\begin{tikzpicture}
		\tikzstyle{sample}=[bottom color=orange,top color=\timecolour,fill opacity=.7,rounded corners=2.5pt,thick]
		
		\draw[->] (-3,0) -- (3.5,0);
		\draw[->] (0,0) -- (0,2)  node[right] {$\delta(n)$};
		
		\def\sf{0.7}
		\def\sx{0.11}
		\def\sy{0.09}
		
		\foreach \x in {-4,-3,...,4} {
			\draw (\x*\sf-0.1,0.1) -- (\x*\sf+0.1,-0.1);
			\draw (\x*\sf,-0.1) node[below,scale=.9] {$\x$};
		}
		
		\foreach \x in {1,2,...,4} {
			\filldraw[sample] (\x*\sf + \sx,0 + \sy) rectangle ++(-\sx*2,-\sy*2);
			\filldraw[sample] (-\x*\sf + \sx,0 + \sy) rectangle ++(-\sx*2,-\sy*2);
		}
		\filldraw[sample] ( + \sx,1 + \sy) rectangle ++(-\sx*2,-\sy*2);
		\draw (0+0.15,1) node[right] {$1$};
		
		\end{tikzpicture}
	\end{minipage}
    \item \textbf{Βηματική ακολουθία step}:
    
    \begin{minipage}{.5\textwidth}
    \begin{knowledgebox}{Βηματική ακολουθία}
    	\[
    	u(n) = \begin{cases}
    	1 &\quad n \geq 0\\
    	0 &\quad n < 0
    	\end{cases}
    	\]
    \end{knowledgebox}
    
	\end{minipage}
	\begin{minipage}{.5\textwidth}
		\begin{tikzpicture}
		\tikzstyle{sample}=[bottom color=orange,top color=\timecolour,fill opacity=.7,rounded corners=2.5pt,thick]
		
		\draw[->] (-3,0) -- (3.5,0);
		\draw[->] (0,0) -- (0,2)  node[right] {$\mathrm u(n)$};
		
		\def\sf{0.7}
		\def\sx{0.11}
		\def\sy{0.09}
		
		\foreach \x in {-4,-3,...,4} {
			\draw (\x*\sf-0.1,0.1) -- (\x*\sf+0.1,-0.1);
			\draw (\x*\sf,-0.1) node[below,scale=.9] {$\x$};
		}
		
		\foreach \x in {1,2,...,4} {
			\filldraw[sample] (\x*\sf + \sx,1 + \sy) rectangle ++(-\sx*2,-\sy*2);
			\filldraw[sample] (-\x*\sf + \sx,0 + \sy) rectangle ++(-\sx*2,-\sy*2);
		}
		\filldraw[sample] ( + \sx,1 + \sy) rectangle ++(-\sx*2,-\sy*2);
		\draw (0-\sx,1) node[left] {$1$};
		
		\end{tikzpicture}
	\end{minipage}
    
    Μάλιστα, ισχύει ότι:
    \[
    u(n) = \sum_{m=-\infty}^{n} δ(m)
    \]
    κάτι που μας θυμίζει αντίστοιχα από το αναλογικό σήμα ότι \( u(t) = \int_{-\infty}^{t} δ(τ)\dif τ \)
\end{enumpar}

\subsubsection{Συνέλιξη}
Μπορούμε να μετατρέψουμε τη \textbf{συνέλιξη} του αναλογικού σήματος στο ψηφιακό.

Στο αναλογικό, θυμόμαστε ότι, σύμφωνα με τον ορισμό της συνέλιξης:
\[
x(t) = x(t) * δ(t) = \int_{-\infty}^{\infty} x(τ)δ(t-τ) \dif τ
\]
και στο ψηφιακό, μπορούμε να έχουμε κάτι αντίστοιχο: \todo{Add a cool box}
\[
x(n) = \sum_{-\infty}^{\infty} x(m) δ(n-m)
\]

\subsection{Συστήματα}
Στον αναλογικό κόσμο, ένα σύστημα ήταν ένα κουτί που έπαιρνε σήματα εισόδου, τα επεξεργαζόταν, και έβγαζε σήματα εξόδου. Μαθηματικά, είναι μια απεικόνιση συναρτήσεων \( x(t) \) εισόδου σε συναρτήσεις εξόδους.

Επομένως, μπορούμε να ορίσουμε το \textbf{ψηφιακό σύστημα} ως ένα σύστημα που απεικονίζει ακολουθίες
σε ακολουθίες.

 \begin{tikzpicture}[scale=.8]
\draw (0,0) node[rectangle,inner sep=18pt,draw] (s) {Σύστημα};
\draw[->] (s.east) -- ++(1,0) node[right] {$y(n)$};
\draw[<-] (s.west) -- ++(-1,0) node[left] {$x(n)$};

\draw[->,gray!50!brown!50!black] (s) ++(0.2,-2) node[below] {Νόμος $T$} to[bend left] (s);
\end{tikzpicture}

Αντίστοιχα, ένα \textbf{υβριδικό σύστημα} απεικονίζει συναρτήσεις σε ακολουθίες. Δηλαδή έχει είσοδο αναλογικό σήμα, και έξοδο ψηφιακό.

\paragraph{Γραμμικό Σύστημα}
Μπορούμε σε αυτό το σημείο να δώσουμε τον ορισμό του \textbf{γραμμικού συστήματος} που συναντάμε συνέχεια,
για ένα ψηφιακό σύστημα \( T \). Έστω οι έξοδοι \( y_1(n) = T\left[x_1(n)\right] \),
\( y_2(n) = T\left[x_2(n)\right] \). Το σύστημα είναι γραμμικό ανν:
\begin{gather*}
\forall x_1,x_2\quad,\quad \forall a_1,a_2\in\mathbb C:\\
a_1T\left[x_1(n)\right]+a_2T\left[x_2(n)\right] = T\left[a_1x_1(n)+a_2x_2(n)\right]
\end{gather*}

Παραδείγματα:
\begin{itemize}
	\item Το \( y(n) = ax(n) + b \) \textit{δεν} είναι γραμμικό, λόγω του \( b \).
	\item Το \( y(n) = nx(n) \) \textit{είναι} γραμμικό.
\end{itemize}

\paragraph{Αμετάβλητο Κατά τη Μετατόπιση Σύστημα (ΑΚΜ)}
\begin{align*}
	y(n) &= T\left[x(n)\right] \\
	y(n-n_0) &= T\left[x(n-n_0)\right]
\end{align*}
δηλαδή, αν το ενοχλήσουμε τη στιγμή 2 ή τη στιγμή 50, θα δώσει την ίδια έξοδο, ξεκινώντας αντίστοιχα
από τη στιγμή 2 ή τη στιγμή 50.

Παραδείγματα:
\begin{itemize}
	\item Το \( y(n) = ax(n) + b \) \textit{είναι} είναι αμετάβλητο κατά τη μετατόπιση.
	\item Το \( y(n) = nx(n) \) \textit{δεν} είναι αμετάβλητο κατά τη μετατόπιση, λόγω του όρου \( n \).
\end{itemize}

Το σύστημα που προκύπτει από μία διαφορική εξίσωση είναι αμετάβλητο κατά τη μετατόπιση όταν οι συντελεστές των παραγώγων του δεν εξαρτώνται από το χρόνο.

\paragraph{Λίγη προσοχή}
Χρειάζεται κάποια προσοχή στο χειρισμό ΑΚΜ και γραμμικών συστημάτων.

Έστω τα συστήματα που εκφράζουν το νόμο του \emph{Ohm} (\( V=IR \)) σε μια \emph{αντίσταση}:
\begin{align*}
	y_1(t) &= R(t) \cdot x(t)\\
	y_2(t) &= R(x) \cdot x(t)
\end{align*}

Στο πρώτο σύστημα η αντίσταση εξαρτάται από το χρόνο (π.χ. διάβρωση), και στο δεύτερο εξαρτάται από την είσοδο (π.χ. αύξηση θερμοκρασίας \( \implies \) αλλαγή αντίστασης για μεγαλύτερα ρεύματα).

Το πρώτο σύστημα είναι γραμμικό αλλά \emph{όχι} ΑΚΜ, αφού η \( R(t) \) εξαρτάται από το χρόνο.
Το δεύτερο σύστημα είναι ΑΚΜ αλλά \emph{όχι} γραμμικό, αφού η \( R(x) \) εξαρτάται από την είσοδο.

Είναι \textbf{λάθος} να πούμε πως έστω \( R(t)=x(t) \implies y_1(t)=x^2(t)\ \text{(μη γραμμικό)} \), καθώς
η \( R(t) \) είναι μια παράμετρος του συστήματος που δεν μπορεί να είναι ίση με τις διαφορετικές πιθανές
εισόδους του. Παρομοίως, είναι \emph{λάθος} να θεωρήσουμε ότι \( R(x) = R(x(t)) = R(t) \implies y_2(t) = R(t)x(t) \ \text{(μη ΑΚΜ)} \) (δηλαδή ότι αφού η \( R \) εξαρτάται από το \( x \) και το \( x \) εξαρτάται από το χρόνο, άρα η \( R \) εξαρτάται μόνο από το χρόνο).

\paragraph{}
Πιο αυστηρά, ένα σύστημα \( y(n) = T\left[x(n)\right] \) είναι μία \textbf{απεικόνιση}
από το σύνολο όλων των ακολουθιών \( x(n) \in \mathbb R \) (ή \( \mathbb C \))
στο σύνολο όλων των ακολουθιών \( y(n) \in \mathbb C  \) (ή \( \mathbb{C} \))

\subsubsection{Συνέλιξη}
Θυμόμαστε ότι ένα \emph{ψηφιακό} σήμα είναι ίσο με την \emph{ψηφιακή} συνέλιξή του
με την \( δ(n) \) (δέλτα Kroenecker):
\begin{align*}
	x(n) &= \sum_{k=-\infty}^{\infty} x(k)δ(n-k)
	\intertext{Άρα, εφαρμόζοντας το σύστημα στη παραπάνω σχέση:}
	y(n) &= T\left[x(n)\right] = T\left[
	x(k)δ(n-k)
	\right]
	\intertext{Και, αν το $T$ είναι \textbf{γραμμικό}:}
	y(n) &= \sum_{k=-\infty}^{\infty} T\left[x(k)δ(n-k)\right]
	\\ &= \sum_{k=-\infty}^{\infty} x(k) \cdot T\left[δ(n-k)\right]
\end{align*}
Δηλαδή η \textbf{έξοδος} του συστήματος σε κάποια είσοδο \( x(n) \) είναι προκύπτει από τη συνέλιξη
της εισόδου με την \textbf{κρουστική απόκριση} του συστήματος (απόκριση στη \( δ(n) \)), την οποία ορίζουμε:
\begin{knowledgebox}{Κρουστική απόκριση}
	Έστω ότι δίνουμε σε ένα σύστημα είσοδο το δέλτα του Kronecker \( δ(n) \).
	
	Τότε η έξοδός του \( T\left[δ(n)\right] \) είναι η κρουστική απόκριση, την οποία ονομάζουμε
	\( h(n) \):
	\begin{align*}
		h(n) &= T\left[\delta(n)\right]
		\intertext{Μάλιστα, αν θεωρήσουμε ότι το σύστημα είναι ΑΚΜ, ισχύει ακόμα:}
		h(n-k) &= T\left[δ(n-k)\right]
	\end{align*}
\end{knowledgebox}
άρα το παραπάνω σύστημα γράφεται:
\[
y(n)= \sum_{k=-\infty}^{\infty} x(k) \cdot h(n-k)
\]

\begin{theorem}[title=Συμπέρασμα]
	Αν ένα σύστημα \( T:x(n) \to y(n) \) είναι γραμμικό, τότε ορίζω την έννοια της
	\textbf{κρουστικής απόκρισης} του \( t \) ως \( h(n) = T\left[δ(n)\right] \).
	Αν επιπροσθέτως το \( T \) είναι ΑΚΜ, τότε για οποιαδήποτε είσοδο \( x(n) \) μπορώ να γράψω ότι
	η έξοδος θα δίνεται ως:
	\[
	y(n) = \sum_{k=-\infty}^{\infty} x(k)h(n-k) = x(n) * h(n)
	\quad \text{(συνέλιξη των διακριτών ακολουθιών)}
	\]
\end{theorem}

\paragraph{Ιδιότητες}
Οι ιδιότητες της διακριτής συνέλιξης είναι ίδιες με αυτές του πολλαπλασιασμού:
\begin{enumgreekpar}
	\item \textbf{Αντιμεταθετική}: \( x(n) * y(n) = y(n) * x(n) \)
	\item \textbf{Προσεταιριστική}: \( x_1 * (x_2*x_3) = (x_1*x_2)*x_3 \)
	\item \textbf{Επιμεριστική} με πρόσθεση: \( x_1 * (x_2+x_3) = x_1*x_2 + x_1*x_3 \)
	\item \textbf{Ουδέτερο στοιχείο} η \( δ(n) \):\[
	x(n) * δ(n) = x(n)
	\]
\end{enumgreekpar}

\paragraph{Χρήσιμες πληροφορίες}
\begin{itemize}
	\item Μπορούμε να πούμε ότι ένα ψηφιακό σήμα έχει \textbf{διάρκεια}.
	
	Αν \emph{ξεκινάει} (πρώτο μη-0 στοιχείο) στο \( n=D_1 \) και \emph{τελειώνει} (τελευταίο μη-0 στοιχείο) στο \( n=U_1 \), τότε μπορούμε να πούμε ότι έχει διάρκεια:
	\[
	T = U_1-D_1 + 1
	\]
	(προσοχή στον όρο \( +1 \)!)
	
	\todo{graph 9 right}
	
	\item Έστω δύο σήματα:
	\begin{align*}
		x_1(n) \text{ έχει διάρκεια } & N_1\\
		x_2(n) \text{ έχει διάρκεια } & N_2
	\end{align*}
	τότε η συνέλιξή τους έχει διάρκεια:
	\[
	T_3 = T_1+T_2-1
	\]
	
	\begin{questionbox}{Άσκηση για το σπίτι}
 		Φανταστείτε ότι σας δίνονται αρχές \( U_1 \) και τέλη \( D_1 \). Για παράδειγμα, μια ακολουθία
		ξεκινά από το 1813 και τελειώνει στο 1980. Γνωρίζουμε ότι αν συνελίξουμε τέτοιες ακολουθίες
		μεταξύ τους, θα πάρουμε σήματα διάρκειας \( T_3 = T_1+T_2-1 \).
		
		Ζητείται να βρεθεί μια σχέση που, δεδομένων των \( U_1,U_2,D_1,D_2 \), να βρίσκει \textbf{από ποιό σημείο \( U_3 \)} ξεκινάει το αποτέλεσμα της συνέλιξης.
		
		\tcblower
		Η απάντηση θα είναι \( U_3 = U_1+U_2 \) και \( D_3 = D_1+D_2 \)
	\end{questionbox}

	\item \todo{??? See what happens with x(n) * u(n-k)}
\end{itemize}

\paragraph{Παραδείγματα}
\begin{exercise}
	Να συνελιχθούν οι συναρτήσεις:
	\begin{align*}
		x_1(n) &= δ(n) + 2δ(n-1) + 3δ(n-2) + 4δ(n-3)\\
		x_2(n) &= δ(n+1) -2δ(n) + δ(n-1)
	\end{align*}
	\tcblower
	Περιμένουμε η συνέλιξη, με βάση αυτά που είδαμε παραπάνω, να έχει διάρκεια:
	\[
	4+3-1=6
	\]
	
	Πραγματοποιούμε τους υπολογισμούς:
	\begin{align*}
		x_1 * x_2 &=
		x_1(n) * \left[ δ(n+1)-2δ(n)+δ(n+1) \right]
		\\ &= x_1(n) * δ(n+1) - x_1(n)*\left( 2 δ(n) \right) + x_1(n)*δ(n-1)
		\\ &= x_1(n+1) - 2x_1(n) + x_1(n-1)
		\\ &= δ(n+1) + 2δ(n) + 3δ(n-1) + 4δ(n-2) - 2δ(n) - 4δ(n-1) - 6δ(n-2) - 8δ(n-3) + δ(n-1) +2δ(n-2) + 3δ(n-3)+4δ(n-4)
		\\ &= δ(n+1) -5δ(n-3) + 4δ(n-4)
	\end{align*}
	κάτι που όντως έχει διάρκεια 6.
\end{exercise}

\begin{exercise}
Έστω ότι έχουμε συναρτήσεις που ξεκινούν και τελειώνουν σε διάφορα σημεία:
\begin{minipage}{.5\textwidth}
	\[
	y(n) = \begin{cases}
	β^{n-n_0} &\quad n \geq n_0\\
	0 &\quad n < n_0
	\end{cases}
	\]
\end{minipage}
\begin{minipage}{.5\textwidth}
	\[
	x(n) = \begin{cases}
	a^{n} &\quad 0 \geq n \geq N\\
	0&\text{αλλού}
	\end{cases}
	\]
\end{minipage}

Να βρεθεί η συνέλιξή τους.

\tcblower

Μπορούμε να γράψουμε τις παραπάνω συναρτήσεις απλούστερα, εκμεταλλευόμενοι τη \textbf{βηματική step function}:
\begin{align*}
	y(n) &= β^{n-n_0} \cdot \mathrm u (n-n_0)\\
	x(n) &= a^n \cdot \left[
	\mathrm u(n) - \mathrm u(n-N-1)
	\right]
\end{align*}
(με \textit{προσοχή} στον όρο \( -1 \) μέσα στη \( \mathrm{u} \))

Άρα η συνέλιξη βρίσκεται:
\begin{align*}
	z(n) &= x(n) * y(n) \\
	&= \sum_{k=-\infty}^{\infty} β^{n-n_0} \mathrm u (n-n_0)a^n \left[
	\mathrm u(n) - \mathrm u(n-N-1)
	\right]
	\\ &= \sum_{k=-\infty}^{\infty} \left[
	β^{k-n_0}u(k-n_0)\cdot a^{n-k} \left[ u(n-k)-u(n-k-N-1) \right]
	\right]
	\\ &= \sum_{k=-\infty}^{\infty} β^{k-n_0}
	a^{n-k} u(k-n_0)u(n-k)
	- \sum_{k=-\infty}^{\infty} β^{k-n_0}u(k-n_0)a^{n-k} u (n-k-N-1)
	\\ &= β^{-n_0}a^n \sum_{k=n_0}^{n} β^k a^{-k} u (n-n_0)
	- β^{-n_0}a^n \sum_{k=n_0}^{n-N-1}β^ka^{-k}u(n-N-1-n_0)
	\intertext{Προσπαθώντας να φτάσουμε έναν όρο γεωμετρικής προόδου, θα κάνουμε το άθροισμα να ξεκινάει από το 0}
	\\ &=
	a^n β^{-n_0}\left[
	\left(\frac{β}{a}\right)^{n_0}\sum_{k=0}^{n-n_0}\left(\frac{β}{a}\right)^k
	u(n-n_0) - \left(\frac{β}{a}\right)^{n_0}
	\sum_{k=0}^{n-n_0-N-1}\left(\frac{β}{a}\right)^k u(n-N-1-n_0)
	\right]
	\intertext{και ήρθε η ώρα να εκμεταλλευτούμε τους τύπους αθροίσματος γεωμετρικής προόδου}
	\\ &= a^{n-n_0}\left[
	\frac{\left(\frac{β}{a}\right)^{n-n_0+1}-1}{\frac{β}{a}-1}u(n-n_0)
	- \frac{\left(\frac{β}{a}\right)^{n-N_0-1}}{\frac{β}{a}-1}u(n-N-1-n_0)
	\right]
\end{align*}

\end{exercise}

\begin{exercise}
	Έστω η ακολουθία:
	\[
	x(n) = a^n\ \forall n
	\]
	και οι \( y(n), \ z(n) \) αυθαίρετες.
	
	Να δειχθεί ότι:
	\[
	\left[
	x(n)y(n)
	\right]*\left[
	x(n)z(n)
	\right] = x(n)\left[
	y(n)*z(n)
	\right]
	\]
	
	\tcblower
	
	Το αριστερό μέλος της ζητούμενης σχέσης είναι:
	\begin{align*}
		\left[
		x(n)y(n)
		\right]*\left[
		x(n)z(n)
		\right] &=
		\sum_{k=-\infty}^{\infty}
		x(k)y(k)x(n-k)z(n-k)
		\\ &= \sum_{k=-\infty}^{\infty} a^k y(k)a^{n-k} z(n-k)
		\\ &= a^n \sum_{k=-\infty}^{\infty} y(k) z(n-k)
		\\ &= x(n) \cdot \left[y(n) * z(n)\right]
	\end{align*}
\end{exercise}

\begin{exercise}
	Να υπολογιστεί η ενέργεια και η ισχύς του σήματος:
	\[
	x_1(n) = \left( \frac{1}{2} \right)^n u(n)
	\]
	\tcblower
	Η ενέργεια δίνεται από τον τύπο:
	\begin{align*}
		E_{x_1} &=
		\sum_{n=-\infty}^{\infty}x_1^2(n) = \sum_{n=-\infty}^{\infty}\left(\frac{1}{2}\right)^{2n}
		u(n) = \sum_{n=0}^{\infty}\left( \frac{1}{4} \right)^n
		\\ &= \frac{1}{1-\frac{1}{4}} = \frac{4}{3}
	\end{align*}
	
	Έχουμε αποδείξει ότι το σήμα είναι σήμα ενέργειας, άρα σίγουρα δεν είναι σήμα ισχύος, δηλαδή η ισχύς του είναι:
	\[
	P=0
	\]
	
	Εναλλακτικά, η ισχύς είναι η ενέργεια διά τη διάρκεια του σήματος, δηλαδή:
	\[
	P = \frac{\sfrac{4}{3} }{\infty} = 0
	\]
\end{exercise}

\begin{exercise}
	Να υπολογιστεί η ενέργεια \& η ισχύς του σήματος:
	\[
	x_2(n) = e^{j\left( n\frac{π}{2} + \frac{π}{8} \right)}
	\]
	\tcblower
	Έχουμε:
	\[
	E_{x_2} = \sum_{n=-\infty}^{\infty} \left|x_2(n)\right|^2 = \sum_{n=-\infty}^{\infty} |1|^2 = \infty
	\]
	
	Η ισχύς του σήματος είναι:
	\[
	P_a = \lim_{N\to \infty}\frac{1}{2N+1}
	\sum_{n=-N}^{N} \cancelto{1}{\left|x_2(n)\right|^2}
	= \lim_{N\to \infty}\frac{2N+1}{2N+1} = 1
	\]
\end{exercise}

\begin{exercise}
	\begin{align*}
	x(n) &= 2^n u(-n-1)\\
	y(n) &= 4^n u(-n-1)
	\end{align*}
	
	Να βρείτε τη συνέλιξή τους:
	\[
	x(n) * y(n) = z(n)
	\]
	
	\tcblower
	Έχουμε:
	\begin{align*}
		z(n) &= \sum_{k=-\infty}^{\infty} x(k)y(n-k)
		\\ &= \sum_{k=-\infty}^{\infty}
		2^k u(-k-1) 4^{n-k} u \left(-(n-k)-1\right)
		\\ &= 4^n\sum_{k=-\infty}^{\infty}\left(\frac{2}{4}\right)^k u(-k-1)u(-n-1+k)
		\\ &= 4^n\sum_{k=n+1}^{-1} \left(\frac{1}{2}\right)^k u(-1-n-1)
		\\ &= 4^n\left(\frac{1}{2}\right)^{n+1}\ \cdot \ \sum_{k=0}^{-n-2}\left(\frac{1}{2}\right)^k
		u(-1-n-1)
		\\ &= 4^n \left(\frac{1}{2}\right)^{n+1}
		\frac{\left(\frac{1}{2}\right)^{-n-1}-1}{\frac{1}{2}-1}u(-n-2)
		\\ &= \left(2^n-2^{2n+1}\right)u(-n-2)
	\end{align*}
\end{exercise}

\begin{questionbox}{Άσκηση για το σπίτι}
	Να γίνει η συνέλιξη των δύο ακολουθιών:
	\begin{align*}
		x(n) &= u(-n-1)\\
		y(n) &= \left(\frac{1}{2}\right)^n u(n)
	\end{align*}
\end{questionbox}

\subsubsection{Ευστάθεια}
Την ευστάθεια μπορούμε να την ορίσουμε με διαφορετικούς ασύμβατους τρόπους.

Εμείς θα χρησιμοποιούμε την \textbf{ευστάθεια κατά ΦΕΦΕ (Φραγμένη Είσοδος \textendash~Φραγμένη Έξοδος)} (BIBO \textemdash~ Bounded Input \textendash~Bounded Output).

\begin{defn}{Φραγμένη ακολουθία}{}
	Μια \textbf{φραγμένη} ακολουθία \( x(n) \)είναι αυτή που δεν πιάνει τιμές μέχρι το άπειρο:
	\[
	\left|x(n)\right| < M < \infty \ \forall n \in \mathbb Z
	\]
\end{defn}

\begin{defn}{Ευστάθεια συστήματος κατά ΦΕΦΕ}{}
	Αν \( \forall x(n) \) φραγμένη είσοδο, η έξοδος \( y(n) \) ενός συστήματος 
	είναι \textbf{φραγμένη}, τότε το σύστημα είναι \textbf{ευσταθές κατά ΦΕΦΕ (BIBO)}.
\end{defn}

\begin{theorem}{Πόρισμα}{}
	Αν το σύστημα γνωρίζουμε ότι είναι \emph{γραμμικό} και \emph{ΑΚΜ} (άρα \( \exists\ h(n) \), δηλαδή υπάρχει η κρουστική του απόκριση), τότε το σύστημα είναι \textbf{ευσταθές} ανν
	\[
	\sum_{n=-\infty}^{\infty} \left|h(n)\right| < \infty
	\]
\end{theorem}
\subparagraph{Απόδειξη}
Για τις δύο κατευθύνσεις:
\begin{itemize}
	\item Εξετάζω ότι \( \sum_{n=-\infty}^{\infty} \left|h(n)\right| < \infty \implies \text{ευστάθεια κατά BIBO} \):
	
	Αφού το άθροισμα της κρουστικής απόκρισης είναι φραγμένο, θα ισχύει \( \displaystyle
	\sum_{n=-\infty}^{\infty} \left|h(n) \right| < L \) για κάποιο (μεγάλο) \( L \).
	
	Έστω \( x(n) \) φραγμένη είσοδος \( \iff \left|x(n)\right| < M \ \forall n \), η έξοδος θα είναι:
	\begin{align*}
		y(n) &= \sum_{k=-\infty}^{\infty} h(k)x(n-k)
		\\ \implies \left|y(n)\right| &= \left|\sum_{k=-\infty}^{\infty} h(k)x(n-k) \right|
		\leq \sum_{k=-\infty}^{\infty} \left|h(k)\right|\left|x(n-k)\right|
		\\ \implies \left|y(n)\right| &< M \sum_{k=-\infty}^{\infty} \left|h(n)\right|
		= N
	\end{align*}
	
	Άρα \( \left|y(n)\right| < N \), άρα η έξοδος είναι φραγμένη.
	
	\item Εξετάζω ότι \( \text{BIBO} \implies \sum_{n=-\infty}^{\infty} \left|h(n)\right| < \infty \).
	
	Εναλλακτικά θα εξετάσω το \textit{αντιθετοαντίστροφο}, δηλαδή ότι
	\( \displaystyle \sum_{n=-\infty}^{\infty} \left|h(n)\right| = \infty \implies
	\text{όχι BIBO} \)
	
	Ορίζω μία νέα ακολουθία \( x(n) \) ως εξής:
	\[
	x(n) = 
	\begin{cases}
	\frac{h^*(-n)}{\left| h(-n) \right|} 
 &\quad \text{αν } h(-n) \neq 0\\
	 0 &\quad \text{αλλού}
	 \end{cases}
	\]
	
	Η \( x(n) \) είναι φραγμένη, αφού έχει μοναδιαίο ή μηδενικό μέτρο παντού. Επομένως είναι \emph{φραγμένη}. Θα την πετάξουμε ως είσοδο στο σύστημα για να αποδείξουμε ότι αυτό
	δίνει \textbf{μη φραγμένη έξοδο, για φραγμένη είσοδο}, άρα είναι ασταθές κατά BIBO:
	
	\begin{align*}
		y(n) &= \sum_{k=-\infty}^{\infty} h(k)x(n-k) \\
		\left|y(n)\right| &= \left| \sum_{k=-\infty}^{\infty} h(k)x(n-k) \right|\\
		\left|y(n)\right| &= 
	\end{align*}
	
	\todo{blablabla}
\end{itemize}

\subsubsection{Αιτιατότητα}
\begin{defn}{Αιτιατό σύστημα}{}
	Ένα σύστημα είναι \textbf{αιτιατό} αν η έξοδος εξαρτάται μόνο από \textbf{παρελθούσες τιμές} της εισόδου ή/και την τρέχουσα (παρούσα).
	
	Μαθηματικά:
	\[
	y(n) = f\left( x(k),x(λ),x(ξ), \dots, x(p) \right)
	\]
	όπου \( κ,λ,ξ,\dots,p \leq n \)
\end{defn}

\begin{theorem}{}{}
	Ένα γρ. ΑΚΜ σύστημα θα είναι \textbf{αιτιατό} αν:
	\[
	h(n) = 0 \ \forall n<0
	\]
	δηλαδή αν η κρουστική απόκριση είναι \textbf{αιτιατή ακολουθία}
\end{theorem}
\subparagraph{Απόδειξη}
Η έξοδος του συστήματος θα είναι:
\begin{align*}
	y(n) &= \sum_{k=-\infty}^{\infty} h(k)x(n-k)
\end{align*}
Εμείς θέλουμε ο δείκτης του \( x \) να μην είναι ποτέ \emph{μεγαλύτερος} από το \( n \),
διότι σε αυτήν την περίπτωση η έξοδος θα εξαρτιόταν από το \emph{μέλλον} του \( x(n) \). Δηλαδή
το \( y(n) \) θα εξαρτάται από τα \( x(n+1), x(n+2), \dots \). Άρα θέλουμε \( k > 0 \).

Αυτό εξασφαλίζεται όταν \( h(k) = 0\ \forall k < 0 \). Τότε η έξοδος θα είναι:
\begin{align*}
	y(n) &= \sum_{k=0}^{\infty} h(k)x(n-k)
\end{align*}

Το παραπάνω βέβαια, δεδομένου του ορισμού της συνέλιξης, γράφεται και ως εξής:
\begin{align*}
	y(n) &= h(n) * x(n) = x(n) * h(n)
	\\ &= \sum_{k=-\infty}^{\infty}x(k)h(n-k)
	\\ &= \sum_{k=-\infty}^{n} x(k)h(n-k)
\end{align*}

\subsubsection{Μερικοί χρήσιμοι ορισμοί για ακολουθίες}
\begin{enumgreekpar}
	\item \textbf{Αιτιατή ακολουθία:} \( x(n) = 0 \quad \forall\ n<0 \)
	\item \textbf{Ακολουθία δεξιάς πλευράς:} \( \exists \ M \in \mathbb Z:\ x(n) = 0 \quad \forall \ n<M \)
	\item \textbf{Ακολουθία αντιαιτιατή:} \( x(n) = 0\quad \forall\ n \geq 0 \)
	\item \textbf{Ακολουθία αριστερής πλευράς:} \( \exists\ M \in \mathbb Z : \ x(n) = 0 \quad \forall \ n>M \)
	\item \textbf{Ακολουθία πεπερασμένης διάρκειας:} \( \exists \ M,N\ M<N:\ \forall n < M \text{ ή } n>N:\ x(n) = 0 \)
\end{enumgreekpar}

Κάθε αιτιατή ακολουθία είναι δεξιάς πλευράς.

\subsubsection{Απόκριση γραμμικού ΑΚΜ συστήματος σε εκθετική είσοδο}
Μελετάμε την απόκριση συστήματος σε είσοδο:
\[
x(n) = a^n
\]
όπου \( a\in\mathbb{C} \).

Τότε η έξοδος είναι:
\todo{fix spacing}
\begin{align*}
	y(n) = h(n) * x(n)  &= \sum_{k=-\infty}^{\infty} h(k) x(n-k)
	\\ &= \sum_{k=-\infty}^{\infty} h(k) a^{n-k}
	\\ &= a^n \sum_{k=-\infty}^{\infty} h(k)a^{-k}
	\\ &= x(n) \cdot \sum_{k=-\infty}^{\infty} \underbrace{h(k)a^{-k}}_{\mathclap{\text{αριθμός που δεν εξαρτάται από το $n$}}}
	\\ &= x(n) \cdot H
\end{align*}

Το τελικό αποτέλεσμα δηλαδή θα είναι η είσοδος \textbf{πολλαπλασιασμένη με έναν αριθμό} που
εξαρτάται από την κρουστική απόκριση του συστήματος και τη βάση \( a \) της εισόδου.
\begin{itemize}
	\item
Έστω ότι:
\[
\infoboxed{a = e^{j\omega }} \quad \implies x(n) = e^{j\omega n}
\]
για \( \omega \in \mathbb R \) μία συνεχή μεταβλητή.

Άρα η έξοδος θα είναι:
\[
y(n) = x(n) \cdot \boxed{\sum_{k=-\infty}^{\infty} h(k) e^{-j\omega k}}
\]
το πλαίσιο είναι ουσιαστικά μία συνάρτηση που εξαρτάται από το \( e^{j\omega}  \), ή
πρακτικά μόνο από το \( \omega  \). Ονομάζουμε αυτήν τη συνάρτηση \( H(\omega ) \):
\[
H(\omega ) = \sum_{k=-\infty}^{\infty} h(k)e^{-j\omega k}
\]
αυτή ουσιαστικά είναι η \textbf{απόκριση συχνότητας του συστήματος}.

Υπενθυμίζουμε ότι το \( \omega  \) είναι \textbf{συνεχής μεταβλητή}. Μπορούμε να ορίσουμε
έναν συνεχή μετασχηματισμό Fourier ως εξής:
\[
x(n) \rightarrow X(\omega ) = \sum_{n=-\infty}^{\infty} x(n) e^{-j\omega n}
\]
\item
Έστω ότι:
\[
\infoboxed{a = z}
\]
δηλαδή το \( a \) ανήκει οπουδήποτε στο μιγαδικό επίπεδο
Τότε:
\[
y(n) = x(n) \cdot \boxed{\sum_{k=-\infty}^{\infty} h(k) z^{-k}}
\]
\end{itemize}

\begin{defn}{Απόκριση συχνότητας}{}
	Ως \textbf{απόκριση συχνότητας} του συστήματος ορίζουμε τη συνάρτηση:
	\begin{align*}
		H\left(e^{j\omega }\right) &= \sum_{k=-\infty}^{\infty}h(k)e^{-j\omega k}
		\\ &= H_R\left(e^{j\omega }\right) + j H_I\left(e^{j\omega }\right)
		\\ &=
		\underbrace{\left|H\left(e^{j\omega }\right)\right|}_{\mathclap{\text{απόκριση πλάτους}}}
		\exp\underbrace{\left[j \mathop{arg} \left(H\left(e^{j\omega t}\right)\right)\right]}_{\mathclap{\text{απόκριση φάσης}}}
	\end{align*}
\end{defn}

\subsubsection{Απόκριση συστήματος σε ημιτονοειδείς συναρτήσεις}
Έστω η είσοδος:
\[
x(n) = A\cos\left( \omega_0 n + \phi \right)
\]

Υπενθυμίζουμε ότι η είσοδος εν γένει \textbf{δεν είναι περιοδική}.

Αντικαθιστούμε το συνημίτονο:
\[
x(n) = A\frac{e^{j\phi}e^{j\omega_0 n} + e^{-j\phi}e^{-j\omega_0n}}{2}
\]
οπότε κατά τα παραπάνω, η έξοδος θα είναι:
\begin{align*}
	y(n) &= \frac{A}{2}e^{j\phi}e^{j\omega_0 n} H\left(e^{j\omega_0}\right)
	+ \frac{A}{2}e^{-j\phi}e^{-j\omega_0 n} H\left(e^{-j\omega_0}\right)
\end{align*}

Εφ' όσον θεωρηθεί ότι \( h(n) \in \mathbb R \), τότε θα ισχύει \( H\left( e^{j\omega_0} \right) = H^*\left(e^{-j\omega_0}\right) \). Άρα τελικά:
\begin{align*}
	y(n) &= \frac{A}{2} e^{j\phi} e^{j\omega_0 n} \left| H\left(e^{j\omega_0}\right) \right|
	\exp \left[j \mathop{arg}\left( H\left(e^{j\omega_0}\right) \right)\right]
	+ \frac{A}{2} e^{j\phi} e^{-j \omega_0 n}
	\left| H\left(e^{j\omega_0}\right) \right| \exp \left[-j\mathop{arg} \left(
	H\left(e^{j\omega_0}\right)
	\right)\right]
	\\ &= A\left| H\left( e^{j\omega_0} \right) \right|
	\cos\left( \omega_0 n + \phi + \mathop{arg}\left(H\left(e^{j\omega_0}\right)\right) \right)
\end{align*}

\begin{exercise}
	Να βρεθεί η απόκριση συχνότητας του συστήματος με μοναδιαία απόκριση \( h(n) = a^n \mathrm{u}(n) \) για \( |a| < 1 \).
	
	\tcblower
	Εύκολα φαίνεται ότι το σύστημα είναι αιτιατό και ευσταθές.
	
	Για την απόκρισή του, από τον ορισμό της έχουμε:
	\begin{align*}
		H\left(e^{j\omega }\right)
		&= \sum_{n=-\infty}^{\infty} h(n) e^{-j\omega n}
		\\ &= \sum_{n=0}^{\infty} a^n e^{-j\omega n}
		\\ &= \sum_{n=0}^{\infty}\left( ae^{-j\omega } \right)^n
		\intertext{Σε αυτό το σημείο εκμεταλλευόμαστε το άθροισμα άπειρων όρων γεωμετρικής προόδου}
		&= \frac{1}{1-ae^{-j\omega }} \quad \text{(επειδή $\left|ae^{-j\omega }\right|=|a|<1$)}
		\intertext{Άρα η απόκριση πλάτους \& συχνότητας θα είναι}:
		\left| H\left(e^{j\omega }\right) \right|
		&= \frac{1}{\left(1+a^2-2a\cos \omega \right)^{\sfrac{1}{2} }}
		\\
		\mathop{arg}\left(H\left(e^{j\omega }\right)\right)
		&= \cdots
	\end{align*}
	\todo{συμπλήρωση}
\end{exercise}

\begin{exercise}
	Δίνεται γρ. ΑΚΜ σύστημα με:\[
	h(n) = \frac{1}{2}δ(n) + δ(n-1) + \frac{1}{2}δ(n-2)
	\]
	
	Να χαρακτηριστεί και να βρεθεί η απόκριση συχνότητάς του.
	\tcblower
	Το σύστημα είναι αιτιατό \& ευσταθές.
	
	Σύμφωνα με τον ορισμό, έχουμε:
	\begin{align*}
		H\left(e^{j\omega }\right) &= \sum_{n=-\infty}^{\infty}
		h(n) e^{-j\omega n}
		\\ &= \sum_{n=-\infty}^{\infty}
		\left[
		\frac{1}{2}δ(n) + δ(n-1) + \frac{1}{2}δ(n-2)
		\right]e^{-j\omega n}
		\\ &= \frac{1}{2}e^{-j\omega 0}
		+ e^{-j\omega 1}
		+ \frac{1}{2}e^{-j\omega 2}
		\\ &= e^{-j\omega } \left[ \frac{1}{2}e^{j\omega } + 1 + \frac{1}{2}e^{-j\omega }  \right]
		\\ &= e^{-j\omega } (1 + \cos \omega)
		\intertext{Άρα σε πλάτος και φάση:}
		\left|
		H\left(e^{j\omega }\right)
		\right| &= \left|1+\cos \omega \right| = 1 + \cos \omega 
		\\
		\mathop{arg}\left[H\left(e^{j\omega }\right)\right]
		&= \mathop{arg} \left[
		e^{-j\omega(1+\cos \omega) }
		\right]
		= \mathop{arg}\left[e^{-j\omega}\right] +\underbrace{ \mathop{arg}\left[1+\cos\omega\right]}_{\mathclap{\text{επειδή $1+\cos\omega \geq 0$}}}
		= -\omega + 0 = -\omega
	\end{align*}
	
	\todo{Diagrams: Plot and phase of above}
\end{exercise}


\end{document}
