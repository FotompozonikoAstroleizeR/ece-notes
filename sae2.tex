% !TeX program = xelatex
\documentclass[11pt,a4paper,notitlepage,fleqn,final]{article}

\input{preamble.tex}

\title{ΣΑΕ 2
	\\
	{ 
		\normalsize Συστήματα Αυτομάτου Ελέγχου II
		\\
		\normalsize Σημειώσεις από τις παραδόσεις
	}}
\date{Φεβρουάριος 2018
	\\
	{ 
		\small Τελευταία ενημέρωση: \today
	}
}
\author{
	Για τον κώδικα σε \LaTeX, ενημερώσεις και προτάσεις:
	\\
	\url{https://github.com/kongr45gpen/ece-notes}}

\setallmainfonts(Digits,Latin,Greek){Asana Math}
\setmainfont{Noto Serif}
\setsansfont{Ubuntu}
\usepackage{polyglossia}
\newfontfamily\greekfont[Script=Greek,Scale=1.00]{Liberation Serif}

\hypersetup{pdftitle = {ΣΑΕ 2}}


\begin{document}
\maketitle

\hrule
\vspace{50pt}

\begin{infobox}{Λάθη \& Διορθώσεις}
	Οι τελευταίες εκδόσεις των σημειώσεων βρίσκονται στο Github
	(\url{https://github.com/kongr45gpen/ece-notes/raw/master/sae1=2.pdf}) ή
	στη διεύθυνση \url{http://helit.org/ece-notes/sae2.pdf}.
	
	Περιέχουν διορθώσεις σε λάθη και τυχόν βελτιώσεις.
	
	\tcblower
	
	Μπορείτε να ενημερώνετε για οποιοδήποτε λάθος και πρόταση
	μέσω PM στο forum, issue στο Github, ή οποιουδήποτε άλλου τρόπου!
\end{infobox}
	
Το μάθημα περιλαμβάνει ένα μικρό προαιρετικό εργαστήριο. Η επιλογή γίνεται με βάση
προαιρετικής προόδου (μπαίνουν οι πρώτοι 18, εφ' όσον έχουν γράψει βαθμό \( \geq 6 \)).

Εφ' όσον δοθεί, η πρόοδος συμμετέχει κατά 25\% στον τελικό βαθμό
(και το υπόλοιπο 75\% στις εξετάσεις), για αυτούς που συμμετάσχουν
σε αυτήν. Διαφορετικά, μετράν οι εξετάσεις κατά 100\%. Το εργαστήριο μετράει προσθετικά
με μέγιστο βαθμό \( +3 \), εφ' όσον ο βαθμός της εξέτασης είναι από 4 και πάνω.

Αν δηλωθεί η πρόοδος, ο βαθμός της μετράει όπως παραπάνω, και δεν υπάρχει δυνατότητα να
ακυρωθεί, ακόμα και αν ο φοιτητής δεν την παραδώσει.

\newpage

\tableofcontents

\newpage

\subsection{Εισαγωγή}
Στα Συστήματα Αυτόματου Ελέγχου 2 οι αναλύσεις γίνονται στο πεδίο του \textbf{χρόνου}
και όχι της \textbf{συχνότητας}. Αυτό επιτρέπει να μελετηθούν συστήματα μη γραμμικά,
καθώς και συστήματα με περισσότερες από μία εισόδους και εξόδους.

Γενικότερα, τα ΣΑΕ έχουν εφαρμογές σε πολυάριθμους τομείς, όπως η αυτοκίνηση (φρένα
ABS, σύστημα πρόσφυσης, διατήρηση ευστάθειας σε πλαγιολίσθηση, \textellipsis), έλεγχος
κινητήρων, έλεγχος υπερμεγέθων τηλεσκοπίων, κατανομή πρόσβασης σε δίκτυα internet και
τηλεφωνικά, διαχείριση συστημάτων ενέργειας (για διανομή, ασφάλεια, αξιοπιστία, π.χ.
απόσβεση διαταραχών μετά από κεραυνό)\textellipsis

Θυμόμαστε ότι \textbf{\textit{σύστημα}} είναι οποιαδήποτε λειτουργική μονάδα που διεγείρεται
από κάποιες εισόδους, και επιστρέφει κάποιες εξόδους.

\begin{tikzpicture}
\draw (0,0) node[rectangle,draw,inner sep=15pt,minimum width=20pt] (r) {$S$};
\draw[<-] (r.west) -- ++(-2,0) node[above right] {είσοδος};
\draw[->] (r.east) -- ++(2,0) node[above left] {έξοδος};
\end{tikzpicture}

Ένα \textbf{ελεγχόμενο σύστημα} είναι τέτοιο ώστε να φροντίζουμε η έξοδος \( y \) να έχει μια
επιθυμητή τιμή \( r \), και το οποίο συχνά περιλαμβάνει και μια είσοδο διαταραχής
\( d \), που δεν μπορούμε να ελέγξουμε.

\begin{tikzpicture}
\draw (0,0) node[rectangle,draw,inner sep=15pt,minimum width=20pt] (r) {$S$};
\draw[<-] (r.west) ++ (0,-0.3) -- ++(-2,0) node[above right] {$u$};
\draw[<-] (r.west) ++ (0,0.3) -- ++(-2,0) node[above right] {$r$};
\draw[<-] (r.north) -- ++(0,1) node[midway,right] {$d(t)$};
\draw[->] (r.east) -- ++(2,0) node[above left] {$y$};
\end{tikzpicture}

Μια ακόμα χρήσιμη έννοια που μάθαμε είναι αυτή της ανάδρασης, στην οποία η έξοδος του συστήματος ανατροφοδοτείται στο σύστημα ως είσοδος, ίσως αφού περαστεί από έναν
ελεγκτή \( C \). Σε αυτά μπορούμε να προσθέσουμε μια μετρητική διάταξη \( M \) και έναν
ενεργοποιητή (actuator) που να μετατρέπει την έξοδο σε μορφή αποδεκτή από το σύστημα. Αυτά
είναι και τα \textbf{συστήματα κλειστού βρόχου}.

\begin{tikzpicture}
\draw (0,0) node[rectangle,draw,inner sep=15pt,minimum width=20pt] (r) {$S$};
\draw (-3,0) node[rectangle,draw,inner sep=10pt,minimum width=10pt] (c) {$C$};
\draw (-1.5,0) node[rectangle,draw,minimum height=30pt,minimum width=7pt] (e) {$E$};

\draw (-0.5,-1.5) node[rectangle,draw,minimum width=30pt,inner sep=8pt] (d) {$M$};

\draw[->] (e) -- (r) node[midway, above] {$u$};
\draw[->] (c) -- (e);
\draw[<-] (c.west) ++ (0,0.3) -- ++(-2,0) node[above right] {$r$};
\draw[<-] (r.north) -- ++(0,1) node[midway,right] {$d(t)$};
\draw[->] (r.east) -- ++(2,0) node[above left] {$y$} node[midway] (m) {};

\draw[->] (m.center) node[circ] {} |- (d) -- ++(-3.5,0) |- (c);
\end{tikzpicture}

Στόχος των μαθημάτων είναι ο σχεδιασμός του ελεγκτή \( C \) ώστε να ικανοποιούνται
συγκεκριμένες προδιαγραφές. Χρειάζεται βέβαια και μια διαισθητική κατανόηση των εννοιών.
Για παράδειγμα, αν έχουμε προδιαγραφή το σύστημα να έχει έξοδο \( 1 \) στη μόνιμη κατάσταση,
είναι προτιμότερο να φτάσει σε αυτήν με υπεραποσβεννύμενη απόκριση, παρά με ταλαντώσεις.
\todo{Graph 1}

Για τη \textbf{μοντελοποίηση} των συστημάτων μπορούμε είτε να υπολογίσουμε και να
αναλύσουμε τη φυσική λειτουργία του συστήματος, είτε να μελετήσουμε σύνολα εισόδων και
εξόδων ώστε να προβλέψουμε τη συμπεριφορά τους.

Στην πραγματικότητα βέβαια δεν θα μας δίνονται οι μαθηματικές προδιαγραφές, αλλά οι
φυσικές προδιαγραφές του συστήματος.

Υπάρχει μάλιστα η περίπτωση τα λειτουργικά κομμάτια των παραπάνω διατάξεων να μην
είναι συνδεδεμένα φυσικά μεταξύ τους, αλλά να βρίσκονται σε απόσταση, εισάγοντας
χρονικές καθυστερήσεις στη μεταφορά των σημάτων (π.χ. drones). Άλλα προβλήματα μπορεί
να είναι ο κβαντισμός των σημάτων (π.χ. για ασύρματη μεταφορά δεδομένων), περιορισμοί του
hardware ή του software.

\paragraph{Παράδειγμα}
Έστω ένα αυτοκίνητο μάζας \( m \) που κινείται σε δρόμο κλίσης \( \phi \) με ταχύτητα
\( y(t) \). Στο αυτοκίνητο ασκείται δύναμη οδήγησης \( u(t) \) και δύναμη του αέρα ανάλογη
με την ταχύτητα, με συντελεστή \( a \) (αεροδυναμικός συντελεστής).
Οι τριβές μεταξύ αυτοκινήτου και οδοστρώματος θεωρούνται αμελητέες.

Επιθυμούμε να σχεδιάσουμε έναν ελεγκτή \( u(t) \) που να ελέγχει τη δύναμη οδήγησης, ώστε
το αυτοκίνητο να κινείται με σταθερή ταχύτητα.

\subparagraph{Λύση}
\todo{Graph 2}

Από το νόμο του Νεύτωνα \( \sum F = m\ddot y \)έχουμε:
\[
m\dot y = u - ay -mg\sin\phi
\]
δηλαδή φτάσαμε σε μία διαφορική εξίσωση που μοντελοποιεί το πρόβλημα.

Παρατηρούμε μάλιστα τον όρο \( \left[-mg\sin\phi\right] \), ο οποίος δεν εξαρτάται από μεταβλητές που
μπορούμε να επηρεάσουμε, αλλά μόνο από την κλίση του δρόμου, που πιθανώς αλλάζει. Δηλαδή
αποτελεί την \textbf{είσοδο διαταραχών}.

Η επιθυμητή έξοδος του συστήματος που δίνεται ως είσοδο είναι \( y(t) = r \), και εδώ
θεωρούμε για παράδειγμα ότι \( r = \SI{25}{\meter/\second} \).

\begin{itemize}
	\item Ισχυρίζομαι ότι μπορώ να λύσω το πρόβλημα \textbf{χωρίς κλειστό βρόχο}, δηλαδή
	χωρίς να φτάνει στον ελεγκτή \( C \) η έξοδος \( y \):
	\[
	u(t) = kr(t)
	\]
	
	Και για απλότητα στους υπολογισμούς θεωρώ \( \phi = 0 \).
	
	Τότε, από το παραπάνω μοντέλο του συστήματος, προκύπτει η διαφορική εξίσωση:
	\[
	m\dot y = -ay + k\cdot25
	\]
	με λύση:
	\[
	y(t) = 25\frac{k}{a}\left(
	1-e^{-\frac{a}{m} t}
	\right),\quad t\geq 0
	\]
	ή, αν επιλέξουμε το κέρδος του ελεγκτή να είναι \( k = a \), η ταχύτητα θα γίνει
	όντως \( \SI{25}{\meter/\second} \). Όμως ο χρόνος αποκατάστασης εξαρτάται από τα
	\( a \) και \( m \), που είναι παράμετροι του ελεγχόμενου συστήματος, και δεν μπορούν
	να επηρεαστούν. Δηλαδή ο ρυθμός με τον οποίο συγκλίνουμε στο 25 εξαρτάται μόνο από τις
	παραμέτρους του ελεγχόμενου συστήματος. Συνήθως έχουμε μεγάλη μάζα \( m \) για το
	αυτοκίνητο και μικρό αεροδυναμικό συντελεστή. Επομένως το πηλίκο \( \frac{a}{m} \) είναι
	μικρό και η απόκριση λογικά αργή.
	
	Ακόμα δεν είναι γνωστή τις περισσότερες φορές η τιμή του συντελεστή \( a \). Αν για
	παράδειγμα ανοίξουμε ένα παράθυρο, μεταβάλλεται ανάλογα με το πόσο το έχουμε ανοίξει.
	Γενικότερα στη διαδικασία της σχεδίασης \textbf{δεν μπορούμε να χρησιμοποιήσουμε
		μεγέθη που δεν είναι γνωστά}.
	
	Επίσης, στην περίπτωση που θεωρήσουμε ότι \( \phi \neq 0 \), η λύση θα προκύψει μετά
	από πράξεις:
	\[
	y(t) = \underbrace{\left(\frac{25k}{a} - \frac{mg\sin\phi}{a}\right)}_{\text{θέλουμε } = 25}
	\left(  1-e^{-\frac{a}{m} t} \right)
	\]
	επομένως:
	\[
	k = \frac{25a + mg\sin\phi}{25}
	\]
	το οποίο πάλι δεν μπορεί να υπολογιστεί εύκολα, αφού η κλίση του δρόμου \( \phi \) κάθε
	φορά δεν είναι γνωστή.
	\item Χρησιμοποιούμε \textbf{αναλογικό ελεγκτή κλειστού βρόχου}:
	\[
	u(t) = k \cdot \Big( r(t) - y(t) \Big), \qquad k > 0 
	\]
	
	Τότε η λύση της διαφορικής εξίσωσης θα προκύψει, μετά από πράξεις:
	\[
	y(t) = \left(
	\frac{25k - mg\sin\phi}{a+k}
	\right)\left( 1-e^{-\left(\frac{a+k}{m}\right)t} \right)
	\]
	
	Όσο μεγαλώνουμε το \( k \), ο παράγοντας στον εκθέτη αυξάνεται, άρα μεγαλώνει η ταχύτητα
	σύγκλισης στη μόνιμη τιμή. Όσον αφορά τον πρώτο όρο, για \( k \) που φτάνει στο
	\( \infty \), έχουμε:
	\[
	\lim_{k \to \infty} \left( \frac{mg\sin\phi}{a+k} \right) = 0
	\]
	και ο πρώτος όρος γίνεται 25.
	
	Η μικρή διαφορά που υπάρχει για πεπερασμένες τιμές του \( k \) είναι ουσιαστικά το
	σφάλμα θέσης, που μπορούμε να εξαλείψουμε με έναν ολοκληρωτή.
\end{itemize}

\todo{Lesson 28/2/18, 2}

\subsection{Μοντελοποίηση Συστημάτων}
Η μοντελοποίηση συστημάτων, όπως αναφέραμε σε μια παράγραφο παραπάνω, γίνεται είτε με
φυσική μελέτη του συστήματος, είτε μελετώντας μερικές σχέσεις εισόδου-εξόδου, και εξάγοντας
συμπεράσματα από αυτές. Το αντικείμενο της μοντελοποίησης μελετάται εκτενώς σε μάθημα
επόμενου εξαμήνου, και εδώ θα κάνουμε μια εισαγωγή.

Τα πραγματικά συστήματα είναι από τη φύση τους πολύπλοκα, και επομένως ένα μοντέλο θα εισάγει
σχεδόν πάντα ένα \textbf{σφάλμα}. Το \textbf{σφάλμα μοντελοποίησης} \( e \) εκφράζει τη
διαφορά της τιμής \( \hat y \) που εξάγει το μοντέλο, από την τιμή \( y \) που εξάγει το
πραγματικό σύστημα.
\todo{Graph 3}
Στόχος της μοντελοποίησης είναι η ελαχιστοποίηση αυτού του σφάλματος, το οποίο εκφράζεται
μέσα από την προδιαγραφή της ακρίβειας.

Για παράδειγμα, μπορεί να θέλουμε να προσεγγίσουμε την έξοδο ενός πραγματικού συστήματος
σε μια "επικίνδυνη" είσοδο, την οποία είναι δύσκολο να εφαρμόσουμε στην πραγματικότητα,
αλλά εύκολο να θεωρήσουμε ως είσοδο στο μοντέλο.

Για τη μελέτη των συστημάτων χρησιμοποιούμε τις \textbf{μεταβλητές κατάστασης}, δηλαδή
τις μεταβλητές που είναι απαραίτητο να γνωρίζουμε για να περιγράψουμε πλήρως τη λειτουργία
του συστήματος. Ο ορισμός αυτός προέκυψε από τη μελέτη της κίνησης των πλανητών, η οποία
μπορεί να περιγραφεί από τη θέση και την ταχύτητα του καθενός.

Το σύνολο των τιμών των μεταβλητών κατάστασης ονομάζεται \textbf{σύνολο καταστάσεων}, και
κάθε τιμή (ή διάνυσμα καταστάσεων) ονομάζεται \textbf{κατάσταση}.

\paragraph{Παράδειγμα} Θεωρούμε ένα φυσικό σύστημα με ένα ελατήριο \( k \) και έναν αποσβεστήρα \( c \). Ασκούμε και
μία δύναμη \( u \). Σε αυτό θεωρούμε ότι η μεταβλητή \( q \) εκφράζει τη θέση του
σώματος. Τότε η χρονική παράγωγός της, \( \dot q \), εκφράζει την ταχύτητα του σώματος.
\todo{Graph 4}

Από το θεμελιώδη νόμο της μηχανικής (2\textsuperscript{ος} Νόμος Νεύτωνας):
\[
m\ddot q = -c(\dot q) - kq + u
\]
δηλαδή το \textbf{μοντέλο} του συστήματος είναι το:
\[
m\ddot q + c(\dot q) + kq = u
\]
Το σύστημα αυτό είναι αυτόνομο. Αν είχαμε κάποια εξωτερική δύναμη, θα ήταν μη αυτόνομο.
\begin{defn}{Αυτόνομα συστήματα}{}
	Συστήματα στα οποία \textbf{δεν} ενεργούν \textbf{εξωτερικές δυνάμεις} ονομάζονται
	\textbf{αυτόνομα}.
	
	Συστήματα στα οποία ενεργούν \textbf{εξωτερικές δυνάμεις}, οι οποίες λειτουργούν ως
	είσοδοι και μπορούμε να τις μεταβάλλουμε ώστε να αλλάξει η δυναμική συμπεριφορά του
	συστήματος, ονομάζονται \textbf{μη αυτόνομα}.
\end{defn}

\begin{defn}{Εξισώσεις κατάστασης}{}
	Γενικότερα, για τα συστήματά μας θα προκύπτει μία εξίσωση:
	\[
	F\left(
	q^{(n)},\ q^{(n-1)},\ \dots,\ \dot q,\ q,\ u
	\right) = 0
	\]
	
	Αυτή είναι διαφορική εξίσωση \textbf{τάξης \( n \)}, και μπορεί να αναλυθεί σε
	επιμέρους απλούστερες διαφορικές εξισώσεις της μορφής:
	\[
	\boxed{\begin{aligned}
		\dot x &= f(x,u) \\
		y &= h(x,u)
		\end{aligned}}
	\text{ όπου }\begin{aligned}
		x \in \mathbb R^n\ &\text{το \textbf{διάνυσμα μεταβλητών κατάστασης}},\\
		u \quad&\text{η \textbf{είσοδος του συστήματος}},\\
		y \quad&\text{η \textbf{έξοδος του συστήματος}},\\
		q \quad&\text{μία \textbf{μεταβλητή κατάστασης} ή άλλη παράμετρος του συστήματος}
		\end{aligned}
	\]
	
	Οι παραπάνω εξισώσεις εκφράζουν για κάθε στιγμή τη σχέση των μεταβλητών κατάστασης,
	και ονομάζονται \textbf{εξισώσεις κατάστασης}.
\end{defn}

\paragraph{Παράδειγμα}
\label{sec:nontd_system}
Έστω ένα σύστημα του οποίου η περιγραφή εκφράζεται από τον τύπο:
\[
y^{(n)} + a_1y^{(n-1)} + a_2y^{(n-2)} + \dots + a_{n-1}\dot y + a_n y = u
\label{eq:nontd_system}
\]
όπου \( u\in\mathbb R  \) η είσοδος και \( y\in\mathbb R  \) η έξοδος του συστήματος.

Εδώ παρατηρούμε ότι οι σταθερές \( a_i \) \textbf{δεν εξαρτώνται} από το \textbf{χρόνο}.

\textbf{Επιλέγουμε} να ορίσουμε τις μεταβλητές κατάστασης
\( (x_1,\ x_2,\dots,\ x_n) \) ως τις παραγώγους της εξόδου.
Η συγκεκριμένη επιλογή δουλεύει καλά:
\begin{align*}
	x_1 &= y \\
	x_2 &= \dot y \\
	&\vdots \\
	x_n &= y^{(n-1)}
\end{align*}

Η δυσκολία αλλά και ο στόχος που θέλουμε να πετύχουμε είναι η \textbf{εύρεση των \( n \) εξισώσεων κατάστασης} με βάση τις παραπάνω μεταβλητές. Εδώ παρατηρούμε ότι:
\begin{align*}
	\dot x_1 &= \dot y = x_2\\
	\dot x_2 &= \ddot y = x_3 \\
	&\vdots \\
	\dot x_{n-1} &= x_n
\end{align*}
και από την αρχική Διαφορική Εξίσωση \eqref{eq:nontd_system} έχουμε:
\[
\dot x_n = -a_1x_n -a_2x_{n-1} - \dots - a_{n-1}x_2 -a_nx_1 + u
\]
δηλαδή το σύνολο των εξισώσεων κατάστασης είναι:
\begin{align*}
\dot x_1 &= x_2\\
\dot x_2 &= x_3 \\
&\vdots \\
\dot x_{n-1} &= x_n\\
\dot x_n &= -a_1x_n -a_2x_{n-1} - \dots - a_{n-1}x_2 -a_nx_1 + u
\end{align*}

Σε \textbf{μορφή πίνακα}, οι \textbf{μεταβλητές κατάστασης} είναι:
\[
\dot X = \left[\begin{matrix}
\dot x_1 \\ \dot x_2 \\ \vdots \\ \dot x_n
\end{matrix}\right] = \left[
\begin{matrix}
0 & 1 & 0 & \cdots & 0 \\
0 & 0 & 1 & \cdots & 0 \\
\vdots & \vdots & \vdots & \ddots & 0\\
0 & 0 & 0 & \cdots & 1 \\
-a_n & - a_{n-1} & - a_{n-2} & \cdots & -a_1
\end{matrix}
\right] \left[\begin{matrix}
x_1 \\  x_2 \\ \vdots \\ x_{n-1} \\ x_n
\end{matrix}\right]
+ \left[\begin{matrix}
0\\0\\\vdots\\0\\1
\end{matrix}\right]u
\]
και η \textbf{έξοδος} του συστήματος προκύπτει από:
\[
y= \left[\begin{matrix}
1 & 0 & 0 & \cdots & 0
\end{matrix}\right]\left[\begin{matrix}
x_1\\x_2\\\vdots\\x_n
\end{matrix}\right]
\]

\paragraph{Παράδειγμα με μεγαλύτερη τάξη εξόδου}
\label{sec:nontd_highorder_system}
Έστω το σύστημα:
\[
y^{(n)} + a_1y^{(n-1)} + a_2y^{(n-2)} + \dots + a_{n-1}\dot y + a_n y =
b_0 u^{(n)} + b_1u^{(n-1)} + \dots + b_{n-1}\dot u + b_n u
\label{eq:nontd_highorder_system}
\]

Υπενθυμίζουμε ότι σκοπός είναι να βρούμε ένα σύνολο μεταβλητών κατάστασης που μπορούν
να παράγουν διαφορικές εξισώσεις που μπορούν να λυθούν, ώστε να περιγραφεί η λειτουργία του
συστήματος.

\begin{itemize}
	\item Έστω ότι ακολουθούμε την προσέγγιση του προηγούμενου παραδείγματος, δηλαδή οι
	μεταβλητές κατάστασης είναι:
	\begin{align*}
	x_1 &= y \\
	x_2 &= \dot y \\
	&\vdots \\
	x_n &= y^{(n-1)}
	\end{align*}
	
	Με λύση:
	\begin{align*}
	\dot x_1 &= \dot y = x_2\\
	\dot x_2 &= \ddot y = x_3 \\
	&\vdots \\
	\dot x_{n-1} &= x_n\\
	\dot x_n &= -a_1x_n -a_2x_{n-1} - \dots - a_{n-1}x_2 -a_nx_1 + b_0 u^{(n)} + b_1u^{(n-1)} + \dots + b_{n-1}\dot u + b_n u
	\end{align*}

     Η παραπάνω λύση είναι σωστή, όμως απαιτεί τη γνώση \textbf{παραγώγων υψηλής τάξης} της
     εισόδου \( u \), κάτι το οποίο ιδιαίτερα στα πραγματικά ΣΑΕ δεν μπορεί να υπολογιστεί,
     επειδή απαιτούνται οι μελλοντικές τιμές του συστήματος.
     \item Μία άλλη λύση που προτείνουμε είναι να \textbf{επιλέξουμε}:
     \begin{alignat*}{2}
     	x_1 &= y - \beta_0 u && \\
     	x_2 &= \dot x_1 - \beta_1 u &&= \dot y - \beta_0\dot u - \beta_1u \\
     	&\vdots && \\
     	x_n &= \dot{x_{n-1}} - \beta_{n-1}u
     	&&= y^{(n-1)} - \beta_0u^{(n-1)} - \dots - \beta_{n-2}\dot u - \beta_{n-1}u
     \end{alignat*}
     
     Οι όροι \( \beta_i \) δεν είναι ίδιοι με τους \( b_i \), αλλά ορίζονται ως εξής:
     \begin{align*}
     	\beta_0 &= b_0 \\
     	\beta_1 &= b_1 - a_1\beta_0\\
     	\beta_2 &= b_2 - a_1\beta_1 - a_2\beta_0\\
     	&\vdots\\
     	\beta_n &= b_n - a_1\beta_{n-1}-\dots - a_{n-1}\beta_1 - a_n\beta_0
     \end{align*}
     
     Το παραπάνω σύστημα μπορεί να λυθεί, και αποδεικνύεται ότι η κάθε εξίσωση περιέχει
     την είσοδο \( u \) χωρίς να είναι σε παράγωγο.
\end{itemize}

\begin{exercise}[Παράδειγμα]
	Στο παράδειγμα της προηγούμενης παραγράφου:
	\[
	m\ddot q + c\dot q + kq = u
	\]
	\tcblower
	Η παραπάνω εξίσωση είναι η \textbf{διαφορική εξίσωση του συστήματος}.
	
	Δεν εμφανίζονται ανώτερες παράγωγοι της εισόδου άρα χρησιμοποιούμε την απλή έκφραση
	από επάνω (\autoref{sec:nontd_system}).
	
	Η τάξη της εξίσωσης είναι \textbf{2}, άρα έχουμε \textbf{μόνο 2} μεταβλητές κατάστασης.
	Σύμφωνα με την παράγραφο \autoref{sec:nontd_system}, επιλέγουμε:
	\begin{alignat*}{4}
		x_1 &=q \qquad && \dot x_1&&=x_2 \\
		x_2&=\dot q \qquad && \dot x_2 &&= -\frac{c}{m}x_2 - \frac{k}{m}x_1
		+ \frac{1}{m}u
	\end{alignat*}
	ή, σε μορφή πίνακα:
	\begin{align*}
		\dot x &= \left[\begin{matrix}
		0 & 1 \\ -\frac{k}{m} & -\frac{c}{m}
		\end{matrix}\right]\left[\begin{matrix}
		x_1\\x_2
		\end{matrix}
		\right]+\left[\begin{matrix}
		0\\ \frac{1}{m}
		\end{matrix}\right]u\\
		y &= \left[\begin{matrix}
		1 & 0
		\end{matrix}\right]\left[\begin{matrix}
		x_1 \\ x_2
		\end{matrix}\right]
	\end{align*}
\end{exercise}
\begin{exercise}[Παράδειγμα]
	Να γραφούν οι εξισώσεις κατάστασης του κυκλώματος:
	
	\begin{circuitikz}[american]
		\draw (0,0) to[V=$v_s(t)$] (0,2)
		to[R=$R$,i>^=$i$] (2,2)
		to[cute inductor=$L$] (4,2)
		to[C=$C$] (4,0)
		-- (0,0)
		;
	\end{circuitikz}
	
	\tcblower
	Λύνουμε το σύστημα με βάση τη φυσική του (νόμοι Kirchoff)
	\begin{align*}
		u_s(t) &=
		iR + L\od{i}{t} + \frac{1}{C} \int_{0}^{t} i \dif\tau\\
		L\od[2]{i}{t} + R\od{i}{t} + \frac{1}{C} i &= \od{u_s(t)}{t}
	\end{align*}
	
	Η είσοδος του συστήματος είναι η ανεξάρτητη τροφοδοσία \( u_s(t) \), και η έξοδος
	το ρεύμα \( i \), δηλαδή:
	\begin{align*}
		u &= u_s(t) \\
		y &= i
	\end{align*}
	άρα η τελευταία διαφορική εξίσωση γράφεται απλούστερα:
	\[
	\ddot y + \frac{R}{L}\dot y + \frac{1}{CL} y = \frac{1}{L} \dot u
	= 0\ddot u + \frac{1}{L}\dot u + 0u
	\]
	
	Αφού η είσοδος \( u \) είναι ανώτερης τάξης στη διαφορική αυτή, επιλέγουμε τις μεταβλητές
	κατάστασης με βάση την παράγραφο \autoref{sec:nontd_highorder_system}:
	\begin{align*}
		x_1 &= y-\beta_0u,\qquad \beta_0 = 0\\
		x_2 &= \dot y-\beta_0 \dot u -\beta_1 u,\qquad \beta_1 = \frac{1}{L}
	\end{align*}
	και εκτελώντας πράξεις:
	\begin{align*}
		x_1 = y &\implies \boxed{\dot x_1 = x_2 + \frac{1}{L}u} \\
		x_2 = \dot x_1 - \beta_1 u \implies \dot x_2 = \ddot y - \frac{1}{L}\dot u
		\implies \dot x_2 = -\frac{R}{L}\dot y-\frac{1}{LC}y + \frac{1}{L}\dot u
			- \frac{1}{L} \dot u
		&\implies\boxed{\dot x_2 = -\frac{R}{L}x_2 - \frac{R}{L^2}u-\frac{1}{LC}x}\\
		\boxed{y=x_1}&
	\end{align*}
\end{exercise}

\end{document}
